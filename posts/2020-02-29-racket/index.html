<!doctype html><html lang=en-us><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><script type=text/javascript src=https://latest.cactus.chat/cactus.js></script>
<link rel=stylesheet href=https://latest.cactus.chat/style.css type=text/css><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Racket notes | almo7aya.md</title><link rel=canonical href=/posts/2020-02-29-racket/><meta name=description content="Senior web engineer supercharged with typescript, rust, swift, and lua, with hands on experience on various technologies, love to create and contribute to the open source community, working currectly @[anghami](https://anghami.com)."><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Racket notes"><meta property="og:description" content="Basic 1#lang racket 2(provide (all-defined-out)) 3 4;this is a comment 5 6(define s &#34;hello&#34;) 7 8(define x 3) 9(define y (+ x 2)) 10 11(define cube1 12 (lambda (x) 13 (* x (* x x)))) 14 15(define cube2 16 (lambda (x) 17 (* x x x))) 18 19(define (cube3 x) 20 (* x x x)) 21 22(define (pow1 x y) 23 (if (=y 0) 24 1 25 (* x (pow1 x (- y 1))))) 26 27; currying 28(define pow2 29 (lambda (x) 30 (lambda (y) 31 (pow1 x y)))) List Empty list: null () doesn&#34;t work for null but '() does build a list: (list e1 ."><meta property="og:type" content="article"><meta property="og:url" content="/posts/2020-02-29-racket/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-02-29T09:00:00+00:00"><meta property="article:modified_time" content="2020-02-29T09:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Racket notes"><meta name=twitter:description content="Basic 1#lang racket 2(provide (all-defined-out)) 3 4;this is a comment 5 6(define s &#34;hello&#34;) 7 8(define x 3) 9(define y (+ x 2)) 10 11(define cube1 12 (lambda (x) 13 (* x (* x x)))) 14 15(define cube2 16 (lambda (x) 17 (* x x x))) 18 19(define (cube3 x) 20 (* x x x)) 21 22(define (pow1 x y) 23 (if (=y 0) 24 1 25 (* x (pow1 x (- y 1))))) 26 27; currying 28(define pow2 29 (lambda (x) 30 (lambda (y) 31 (pow1 x y)))) List Empty list: null () doesn&#34;t work for null but '() does build a list: (list e1 ."><link rel=stylesheet href=/css/styles.d059637f2c46390ca59f844950f3823900bc275d9afb71ef6d933bbbfd2bf2f0256c2c45057bd73a5b4a4be1f435c0e2c1098f66454dfbebcf58c41036fb34d2.css integrity="sha512-0FljfyxGOQyln4RJUPOCOQC8J12a+3HvbZM7u/0r8vAlbCxFBXvXOltKS+H0NcDiwQmPZkVN++vPWMQQNvs00g=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=/images/favicon.ico></head><body class=ltr><div class="max-width mx-auto content index pt4 px3"><header id=header><a href=/><div id=title><h1>&nbsp;almo7aya.md&nbsp;</h1><span class=repeated></span></div></a></header><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Racket notes</h1><div class=meta><div class=postdate><time datetime="2020-02-29 09:00:00 +0000 UTC" itemprop=datePublished>2020-02-29</time></div><div class=article-read-time><i class="far fa-clock"></i>
4 minute read</div><div class=article-category><i class="fas fa-archive"></i>
<a class=category-link href=/%20/categories/notes>notes</a></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/%20/tags/racket rel=tag>racket</a></div></div></header><div class=content itemprop=articleBody><h2 id=basic>Basic</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#ff79c6>#lang </span>racket
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>(<span style=color:#ff79c6>provide</span> (<span style=color:#ff79c6>all-defined-out</span>))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#6272a4>;this is a comment</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>(<span style=color:#ff79c6>define</span> s <span style=color:#f1fa8c>&#34;hello&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>(<span style=color:#ff79c6>define</span> x <span style=color:#bd93f9>3</span>)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>(<span style=color:#ff79c6>define</span> y (<span style=color:#8be9fd;font-style:italic>+</span> x <span style=color:#bd93f9>2</span>))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>(<span style=color:#ff79c6>define</span> cube1
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>  (<span style=color:#ff79c6>lambda</span> (x)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>    (<span style=color:#8be9fd;font-style:italic>*</span> x (<span style=color:#8be9fd;font-style:italic>*</span> x x))))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>(<span style=color:#ff79c6>define</span> cube2
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>  (<span style=color:#ff79c6>lambda</span> (x)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>    (<span style=color:#8be9fd;font-style:italic>*</span> x x x)))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>(<span style=color:#ff79c6>define</span> (cube3 x)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>  (<span style=color:#8be9fd;font-style:italic>*</span> x x x))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>(<span style=color:#ff79c6>define</span> (pow1 x y)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>  (<span style=color:#ff79c6>if</span> (=y <span style=color:#bd93f9>0</span>)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>      <span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>      (<span style=color:#8be9fd;font-style:italic>*</span> x (pow1 x (<span style=color:#8be9fd;font-style:italic>-</span> y <span style=color:#bd93f9>1</span>)))))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span><span style=color:#6272a4>; currying</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>(<span style=color:#ff79c6>define</span> pow2
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>  (<span style=color:#ff79c6>lambda</span> (x)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>    (<span style=color:#ff79c6>lambda</span> (y)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>      (pow1 x y))))
</span></span></code></pre></div><h3 id=list>List</h3><ul><li>Empty list: <code>null</code><ul><li><code>()</code> doesn"t work for <code>null</code> but <code>'()</code> does</li></ul></li><li>build a list: <code>(list e1 ... en)</code></li><li>Constructor: <code>cons</code></li><li>Access head of list: <code>car</code></li><li>Access tail of list: <code>cdr</code></li><li>Check for empty: <code>null?</code></li></ul><h3 id=syntax>Syntax</h3><p>A term is either:</p><ul><li>An atom like <code>#t, #f, 34, "hi", null, 4.0, x,...</code></li><li>A special form like <code>define, lambda, if</code></li><li>A sequence of terms in parentheses: <code>(t1 t2 t3)</code></li><li>Can use <code>[</code> anything you use <code>(</code></li></ul><p>Remember parentheses matters! For example:
<code>(e)</code> means call e with 0 argument.</p><h3 id=dynamic-typing>Dynamic typing</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>(<span style=color:#ff79c6>define</span> lst (<span style=color:#8be9fd;font-style:italic>list</span> #t <span style=color:#f1fa8c>&#34;hi&#34;</span> <span style=color:#bd93f9>1</span> (<span style=color:#8be9fd;font-style:italic>list</span> <span style=color:#bd93f9>2</span> <span style=color:#bd93f9>3</span> <span style=color:#bd93f9>4</span>)))
</span></span></code></pre></div><h3 id=cond>Cond</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>(<span style=color:#ff79c6>define</span> (sum3 xs)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>  (<span style=color:#ff79c6>cond</span> [(<span style=color:#8be9fd;font-style:italic>null?</span> xs) <span style=color:#bd93f9>0</span>]
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>        [(<span style=color:#8be9fd;font-style:italic>number?</span> (<span style=color:#8be9fd;font-style:italic>car</span> xs)) (<span style=color:#8be9fd;font-style:italic>+</span> (<span style=color:#8be9fd;font-style:italic>car</span> xs) (sum3 (<span style=color:#8be9fd;font-style:italic>cdr</span> xs)))]
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>        [#t <span style=color:#bd93f9>0</span>]))
</span></span></code></pre></div><h3 id=what-is-true>What is true?</h3><p>Anything that is not <code>#f</code> is true <code>#t</code>.</p><h3 id=local-bindings>Local bindings</h3><h4 id=letletletrec>let/let*/letrec</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>(<span style=color:#ff79c6>let</span> ([x1 e1]
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>      [x2 e2]
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>      <span style=color:#ff79c6>...</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>      [xn en])
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>  e)
</span></span></code></pre></div><p>Racket uses the environment <strong>before</strong> the let-expression to evaluate <code>e1 e2 ... en</code>, which means if <code>en</code> uses <code>x1</code>, <code>x2</code>, that would mean some outer variables of the same name. Instead, the expressions in <code>let*</code> are evaluated in the environment produced from the previous bindings (later ones shadow) .</p><p>The expressions in <code>letrec</code> are evaluated in the environment that includes all th bindings. It is needed for mutual recursion.</p><h3 id=set>set!</h3><p>Racket has assignment statements:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>(<span style=color:#ff79c6>set!</span> x e)
</span></span></code></pre></div><p>Once you have side-effects, sequences are useful:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>(<span style=color:#ff79c6>begin</span> e1 e2 e3)
</span></span></code></pre></div><h3 id=consmcons>cons/mcons</h3><p><code>cons</code> produces pairs or lists. (Actually lists are just extented pairs)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>(<span style=color:#ff79c6>define</span> pr (<span style=color:#8be9fd;font-style:italic>cons</span> <span style=color:#bd93f9>1</span> (<span style=color:#8be9fd;font-style:italic>cons</span> #t <span style=color:#f1fa8c>&#34;hi&#34;</span>))) <span style=color:#6272a4>; is a pair</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>(<span style=color:#ff79c6>define</span> lst (<span style=color:#8be9fd;font-style:italic>cons</span> <span style=color:#bd93f9>1</span> (<span style=color:#8be9fd;font-style:italic>cons</span> #t (<span style=color:#8be9fd;font-style:italic>cons</span> <span style=color:#f1fa8c>&#34;hi&#34;</span> <span style=color:#8be9fd;font-style:italic>null</span>)))) <span style=color:#6272a4>; is a list</span>
</span></span></code></pre></div><p><code>mcons</code> is another way to make pairs which allows you to change the value inside piars:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>(<span style=color:#ff79c6>define</span> mpr (<span style=color:#8be9fd;font-style:italic>mcons</span> <span style=color:#bd93f9>1</span> (<span style=color:#8be9fd;font-style:italic>mcons</span> #t <span style=color:#f1fa8c>&#34;hi&#34;</span>)))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>(<span style=color:#8be9fd;font-style:italic>mcar</span> mpr) <span style=color:#6272a4>; 1</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>(<span style=color:#8be9fd;font-style:italic>mcdr</span> mpr) <span style=color:#6272a4>; (mcons (#t &#34;hi&#34;))</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>(<span style=color:#8be9fd;font-style:italic>set-mcdr!</span> mpr <span style=color:#bd93f9>47</span>) <span style=color:#6272a4>; mpr becomes (mcons 1 47)</span>
</span></span></code></pre></div><p>Related form:</p><ul><li><code>mcons</code></li><li><code>mcar</code></li><li><code>mcdr</code></li><li><code>mpair?</code></li><li><code>set-mcar!</code></li><li><code>set-mcdr!</code></li></ul><h2 id=delayed-evaluation-and-thunk>Delayed Evaluation and Thunk</h2><p>In most programming languages, given <code>e1 e2 ... en</code>, the function arguments <code>e2, ..., en</code> are evaluated once before the function body is executed.
So if we define a function like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rkt data-lang=rkt><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>(<span style=color:#ff79c6>define</span> (my-if-bad x y z) (<span style=color:#ff79c6>if</span> x y z))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>(<span style=color:#ff79c6>define</span> (factorial-wrong x)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>  (my-if-bad (<span style=color:#8be9fd;font-style:italic>=</span> x <span style=color:#bd93f9>0</span>)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>             <span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>             (<span style=color:#8be9fd;font-style:italic>*</span> x (factorial-wrong (<span style=color:#8be9fd;font-style:italic>-</span> x <span style=color:#bd93f9>1</span>)))))
</span></span></code></pre></div><p>if we use <code>if</code> instead of <code>my-if-bad</code>, <code>factorial-wrong</code> acts just like we want. But with <code>my-if-bad</code>, the function never stops because the two branches evaluate at the same time.</p><p>Thanks to lambda, we can delay the evaluation, using the fact that function bodies are not evaluated until the function gets called.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rkt data-lang=rkt><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>(<span style=color:#ff79c6>define</span> (my-if x y z) (<span style=color:#ff79c6>if</span> x (y) (z)))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>(<span style=color:#ff79c6>define</span> (factorial x)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>  (my-if (<span style=color:#8be9fd;font-style:italic>=</span> x <span style=color:#bd93f9>0</span>)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>         (<span style=color:#ff79c6>lambda</span> () <span style=color:#bd93f9>1</span>)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>         (<span style=color:#ff79c6>lambda</span> () (<span style=color:#8be9fd;font-style:italic>*</span> x (factorial (<span style=color:#8be9fd;font-style:italic>-</span> x <span style=color:#bd93f9>1</span>))))))
</span></span></code></pre></div><p>The general idiom of using a zero-argument function to delay evaluation is also called a <strong>thunk</strong> (or, thunk the argument).</p><p>By the way,</p><h2 id=lazy-evaluationcall-by-needpromises>Lazy-evaluation/Call-by-need/Promises</h2><h2 id=streams>Streams</h2><p>A stream is an infinite sequence of values.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#ff79c6>#lang </span>racket
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#6272a4>; 1 1 1 1 ...</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>(<span style=color:#ff79c6>define</span> ones (<span style=color:#ff79c6>lambda</span> () (<span style=color:#8be9fd;font-style:italic>cons</span> <span style=color:#bd93f9>1</span> ones)))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#6272a4>; 1 2 3 4 ...</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>(<span style=color:#ff79c6>define</span> nats
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>  (<span style=color:#ff79c6>letrec</span> ([f (<span style=color:#ff79c6>lambda</span> (x) (<span style=color:#8be9fd;font-style:italic>cons</span> x (<span style=color:#ff79c6>lambda</span> () (f (<span style=color:#8be9fd;font-style:italic>+</span> x <span style=color:#bd93f9>1</span>)))))])
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>     (<span style=color:#ff79c6>lambda</span> () (f <span style=color:#bd93f9>1</span>))))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#6272a4>; 2 4 6 8 ...</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>(<span style=color:#ff79c6>define</span> power-of-two
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>  (<span style=color:#ff79c6>letrec</span> ([f (<span style=color:#ff79c6>lambda</span> (x) (<span style=color:#8be9fd;font-style:italic>cons</span> x (<span style=color:#ff79c6>lambda</span> () (f (<span style=color:#8be9fd;font-style:italic>*</span> x <span style=color:#bd93f9>2</span>)))))])
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>    (<span style=color:#ff79c6>lambda</span> () (f <span style=color:#bd93f9>2</span>))))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#6272a4>; higher-order maker</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>(<span style=color:#ff79c6>define</span> (stream-maker fn arg)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>  (<span style=color:#ff79c6>letrec</span> ([f (<span style=color:#ff79c6>lambda</span> (x) (<span style=color:#8be9fd;font-style:italic>cons</span> x (<span style=color:#ff79c6>lambda</span> () (f (fn x arg)))))])
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>    (<span style=color:#ff79c6>lambda</span> () (f arg))))
</span></span></code></pre></div><h2 id=memoization-not-memorization>Memoization (Not Memorization)</h2><p>Memoization is another idiom related to lazy evaluation that does not actually use thunks. To implement memoization we do use mutation: Whenever the function is called with an argument we have not seen before, we compute the answer and then add the result to the table.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>(<span style=color:#ff79c6>define</span> fibonacci
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>  (<span style=color:#ff79c6>letrec</span>([memo <span style=color:#8be9fd;font-style:italic>null</span>]
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>          [f (<span style=color:#ff79c6>lambda</span> (x)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>               (<span style=color:#ff79c6>let</span> ([ans (<span style=color:#8be9fd;font-style:italic>assoc</span> x memo)])
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>                 (<span style=color:#ff79c6>if</span> ans
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>                     (<span style=color:#8be9fd;font-style:italic>cdr</span> ans)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>                     (<span style=color:#ff79c6>let</span> ([new-ans (<span style=color:#ff79c6>if</span> (<span style=color:#ff79c6>or</span> (<span style=color:#8be9fd;font-style:italic>=</span> x <span style=color:#bd93f9>1</span>) (<span style=color:#8be9fd;font-style:italic>=</span> x <span style=color:#bd93f9>2</span>))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>                                        <span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>                                        (<span style=color:#8be9fd;font-style:italic>+</span> (f (<span style=color:#8be9fd;font-style:italic>-</span> x <span style=color:#bd93f9>1</span>))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>                                           (f (<span style=color:#8be9fd;font-style:italic>-</span> x <span style=color:#bd93f9>2</span>))))])
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>                       (<span style=color:#ff79c6>begin</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>                         (<span style=color:#ff79c6>set!</span> memo (<span style=color:#8be9fd;font-style:italic>cons</span> (<span style=color:#8be9fd;font-style:italic>cons</span> x new-ans) memo))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>                         new-ans)))))])
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>    f))
</span></span></code></pre></div><h2 id=macros>Macros</h2><p>Think about these things about macros and how Racket handles them better than other macro systems(notably C/C++)</p><ul><li>Tokenization</li><li>Parenthesization</li><li>Scope</li></ul><h3 id=syntax-1>Syntax</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>(<span style=color:#ff79c6>define-syntax</span> myif
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>  (<span style=color:#ff79c6>syntax-rules</span> (then <span style=color:#ff79c6>else</span>)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>    [(my-if e1 then e2 <span style=color:#ff79c6>else</span> e3)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>     (<span style=color:#ff79c6>if</span> e1 e2 e3)]))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>(<span style=color:#ff79c6>define-syntax</span> my-delay
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>  (<span style=color:#ff79c6>syntax-rules</span> ()
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>    [(my-delay e)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9</span><span>     (<span style=color:#8be9fd;font-style:italic>mcons</span> #f (<span style=color:#ff79c6>lambda</span> () e))]))
</span></span></code></pre></div><h3 id=hygiene>Hygiene</h3><h2 id=recursive-datatypes-via-racketss-struct>Recursive Datatypes Via Rackets&rsquo;s <code>struct</code></h2><p><a href="https://docs.racket-lang.org/reference/define-struct.html?q=struct#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._struct%29%29">https://docs.racket-lang.org/reference/define-struct.html?q=struct#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._struct%29%29</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>(<span style=color:#ff79c6>struct</span> foo (bar baz quux) <span style=color:#8be9fd;font-style:italic>#:transparent</span>
</span></span></code></pre></div></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/posts>Writings</a></li><li><a href=/about>About</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#basic>Basic</a><ul><li><a href=#list>List</a></li><li><a href=#syntax>Syntax</a></li><li><a href=#dynamic-typing>Dynamic typing</a></li><li><a href=#cond>Cond</a></li><li><a href=#what-is-true>What is true?</a></li><li><a href=#local-bindings>Local bindings</a><ul><li><a href=#letletletrec>let/let*/letrec</a></li></ul></li><li><a href=#set>set!</a></li><li><a href=#consmcons>cons/mcons</a></li></ul></li><li><a href=#delayed-evaluation-and-thunk>Delayed Evaluation and Thunk</a></li><li><a href=#lazy-evaluationcall-by-needpromises>Lazy-evaluation/Call-by-need/Promises</a></li><li><a href=#streams>Streams</a></li><li><a href=#memoization-not-memorization>Memoization (Not Memorization)</a></li><li><a href=#macros>Macros</a><ul><li><a href=#syntax-1>Syntax</a></li><li><a href=#hygiene>Hygiene</a></li></ul></li><li><a href=#recursive-datatypes-via-racketss-struct>Recursive Datatypes Via Rackets&rsquo;s <code>struct</code></a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=%2fposts%2f2020-02-29-racket%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=%2fposts%2f2020-02-29-racket%2f&text=Racket%20notes" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=%2fposts%2f2020-02-29-racket%2f&title=Racket%20notes" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=%2fposts%2f2020-02-29-racket%2f&is_video=false&description=Racket%20notes" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Racket%20notes&body=Check out this article: %2fposts%2f2020-02-29-racket%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=%2fposts%2f2020-02-29-racket%2f&title=Racket%20notes" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=%2fposts%2f2020-02-29-racket%2f&title=Racket%20notes" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=%2fposts%2f2020-02-29-racket%2f&name=Racket%20notes&description=Basic%201%23lang%20racket%202%28provide%20%28all-defined-out%29%29%203%204%3bthis%20is%20a%20comment%205%206%28define%20s%20%26%2334%3bhello%26%2334%3b%29%207%208%28define%20x%203%29%209%28define%20y%20%28%2b%20x%202%29%29%2010%2011%28define%20cube1%2012%20%28lambda%20%28x%29%2013%20%28%2a%20x%20%28%2a%20x%20x%29%29%29%29%2014%2015%28define%20cube2%2016%20%28lambda%20%28x%29%2017%20%28%2a%20x%20x%20x%29%29%29%2018%2019%28define%20%28cube3%20x%29%2020%20%28%2a%20x%20x%20x%29%29%2021%2022%28define%20%28pow1%20x%20y%29%2023%20%28if%20%28%3dy%200%29%2024%201%2025%20%28%2a%20x%20%28pow1%20x%20%28-%20y%201%29%29%29%29%29%2026%2027%3b%20currying%2028%28define%20pow2%2029%20%28lambda%20%28x%29%2030%20%28lambda%20%28y%29%2031%20%28pow1%20x%20y%29%29%29%29%20List%20Empty%20list%3a%20null%20%28%29%20doesn%26quot%3bt%20work%20for%20null%20but%20%27%28%29%20does%20build%20a%20list%3a%20%28list%20e1%20." aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=%2fposts%2f2020-02-29-racket%2f&t=Racket%20notes" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div></div><footer id=footer><img id=image src=/images/avatar.jpg alt><div class=link>Github: <a target=_blank href=https://github.com/almo7aya>@almo7aya</a></div><div class=link>Twitter: <a target=_blank href=https://twitter.com/@almo7aya_>@almo7aya_</a></div><div class=link>LinkedIn: <a target=_blank href=https://linkedin.com/in/almo7aya>Ali Almohaya</a></div><div class=link><a target=_blank href=mailto:alialmohaya@gmail.com>alialmohaya@gmail.com</a></div><div class=license>Content licensed under a <a target=_blank href=https://creativecommons.org/licenses/by/4.0/>CC Attribution 4.0 International
License</a></div></footer></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
<script src=/js/code-copy.js></script></html>