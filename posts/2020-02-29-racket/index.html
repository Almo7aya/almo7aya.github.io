<!doctype html><html lang=en-us><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><script type=text/javascript src=https://latest.cactus.chat/cactus.js></script>
<link rel=stylesheet href=https://latest.cactus.chat/style.css type=text/css><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Racket notes | almo7aya.md</title><link rel=canonical href=/posts/2020-02-29-racket/><meta name=description content="Senior web engineer supercharged with typescript, rust, swift, and lua, with hands on experience on various technologies, love to create and contribute to the open source community, working @ [anghami](https://anghami.com)."><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Racket notes"><meta property="og:description" content="Basic 1#lang racket 2(provide (all-defined-out)) 3 4;this is a comment 5 6(define s &#34;hello&#34;) 7 8(define x 3) 9(define y (+ x 2)) 10 11(define cube1 12 (lambda (x) 13 (* x (* x x)))) 14 15(define cube2 16 (lambda (x) 17 (* x x x))) 18 19(define (cube3 x) 20 (* x x x)) 21 22(define (pow1 x y) 23 (if (=y 0) 24 1 25 (* x (pow1 x (- y 1))))) 26 27; currying 28(define pow2 29 (lambda (x) 30 (lambda (y) 31 (pow1 x y)))) List Empty list: null () doesn&#34;t work for null but '() does build a list: (list e1 ."><meta property="og:type" content="article"><meta property="og:url" content="/posts/2020-02-29-racket/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-02-29T09:00:00+00:00"><meta property="article:modified_time" content="2020-02-29T09:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Racket notes"><meta name=twitter:description content="Basic 1#lang racket 2(provide (all-defined-out)) 3 4;this is a comment 5 6(define s &#34;hello&#34;) 7 8(define x 3) 9(define y (+ x 2)) 10 11(define cube1 12 (lambda (x) 13 (* x (* x x)))) 14 15(define cube2 16 (lambda (x) 17 (* x x x))) 18 19(define (cube3 x) 20 (* x x x)) 21 22(define (pow1 x y) 23 (if (=y 0) 24 1 25 (* x (pow1 x (- y 1))))) 26 27; currying 28(define pow2 29 (lambda (x) 30 (lambda (y) 31 (pow1 x y)))) List Empty list: null () doesn&#34;t work for null but '() does build a list: (list e1 ."><link rel=stylesheet href=/css/styles.87d626b26bb04ac09608d4fb3467f3177cc18e4747ed52c0b6906c90e1e28bebd5fbe2dd6bc84c6c72c132ddda620b2ba467996e1fef0b2876e35323b46105e1.css integrity="sha512-h9YmsmuwSsCWCNT7NGfzF3zBjkdH7VLAtpBskOHii+vV++Lda8hMbHLBMt3aYgsrpGeZbh/vCyh241MjtGEF4Q=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=/images/favicon.ico></head><body class=ltr><div class="max-width mx-auto content index pt4 px3"><header id=header><a href=/><div id=title><h1>&nbsp;almo7aya.md&nbsp;</h1><span class=repeated></span></div></a></header><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Racket notes</h1><div class=meta><div class=postdate><time datetime="2020-02-29 09:00:00 +0000 UTC" itemprop=datePublished>2020-02-29</time></div><div class=article-read-time><i class="far fa-clock"></i>
4 minute read</div><div class=article-category><i class="fas fa-archive"></i>
<a class=category-link href=/%20/categories/notes>notes</a></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/%20/tags/racket rel=tag>racket</a></div></div></header><div class=content itemprop=articleBody><h2 id=basic>Basic</h2><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 1</span><span><span style=color:#fe8019>#lang </span>racket
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 2</span><span>(<span style=color:#fe8019>provide</span> (<span style=color:#fe8019>all-defined-out</span>))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 4</span><span><span style=color:#928374;font-style:italic>;this is a comment</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 5</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 6</span><span>(<span style=color:#fe8019>define</span> s <span style=color:#b8bb26>&#34;hello&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 7</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 8</span><span>(<span style=color:#fe8019>define</span> x <span style=color:#d3869b>3</span>)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 9</span><span>(<span style=color:#fe8019>define</span> y (<span style=color:#fabd2f>+</span> x <span style=color:#d3869b>2</span>))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">10</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">11</span><span>(<span style=color:#fe8019>define</span> cube1
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">12</span><span>  (<span style=color:#fe8019>lambda</span> (x)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">13</span><span>    (<span style=color:#fabd2f>*</span> x (<span style=color:#fabd2f>*</span> x x))))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">14</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">15</span><span>(<span style=color:#fe8019>define</span> cube2
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">16</span><span>  (<span style=color:#fe8019>lambda</span> (x)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">17</span><span>    (<span style=color:#fabd2f>*</span> x x x)))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">18</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">19</span><span>(<span style=color:#fe8019>define</span> (cube3 x)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">20</span><span>  (<span style=color:#fabd2f>*</span> x x x))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">21</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">22</span><span>(<span style=color:#fe8019>define</span> (pow1 x y)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">23</span><span>  (<span style=color:#fe8019>if</span> (=y <span style=color:#d3869b>0</span>)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">24</span><span>      <span style=color:#d3869b>1</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">25</span><span>      (<span style=color:#fabd2f>*</span> x (pow1 x (<span style=color:#fabd2f>-</span> y <span style=color:#d3869b>1</span>)))))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">26</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">27</span><span><span style=color:#928374;font-style:italic>; currying</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">28</span><span>(<span style=color:#fe8019>define</span> pow2
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">29</span><span>  (<span style=color:#fe8019>lambda</span> (x)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">30</span><span>    (<span style=color:#fe8019>lambda</span> (y)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">31</span><span>      (pow1 x y))))
</span></span></code></pre></div><h3 id=list>List</h3><ul><li>Empty list: <code>null</code><ul><li><code>()</code> doesn"t work for <code>null</code> but <code>'()</code> does</li></ul></li><li>build a list: <code>(list e1 ... en)</code></li><li>Constructor: <code>cons</code></li><li>Access head of list: <code>car</code></li><li>Access tail of list: <code>cdr</code></li><li>Check for empty: <code>null?</code></li></ul><h3 id=syntax>Syntax</h3><p>A term is either:</p><ul><li>An atom like <code>#t, #f, 34, "hi", null, 4.0, x,...</code></li><li>A special form like <code>define, lambda, if</code></li><li>A sequence of terms in parentheses: <code>(t1 t2 t3)</code></li><li>Can use <code>[</code> anything you use <code>(</code></li></ul><p>Remember parentheses matters! For example:
<code>(e)</code> means call e with 0 argument.</p><h3 id=dynamic-typing>Dynamic typing</h3><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">1</span><span>(<span style=color:#fe8019>define</span> lst (<span style=color:#fabd2f>list</span> <span style=color:#d3869b>#t</span> <span style=color:#b8bb26>&#34;hi&#34;</span> <span style=color:#d3869b>1</span> (<span style=color:#fabd2f>list</span> <span style=color:#d3869b>2</span> <span style=color:#d3869b>3</span> <span style=color:#d3869b>4</span>)))
</span></span></code></pre></div><h3 id=cond>Cond</h3><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">1</span><span>(<span style=color:#fe8019>define</span> (sum3 xs)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">2</span><span>  (<span style=color:#fe8019>cond</span> [(<span style=color:#fabd2f>null?</span> xs) <span style=color:#d3869b>0</span>]
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">3</span><span>        [(<span style=color:#fabd2f>number?</span> (<span style=color:#fabd2f>car</span> xs)) (<span style=color:#fabd2f>+</span> (<span style=color:#fabd2f>car</span> xs) (sum3 (<span style=color:#fabd2f>cdr</span> xs)))]
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">4</span><span>        [<span style=color:#d3869b>#t</span> <span style=color:#d3869b>0</span>]))
</span></span></code></pre></div><h3 id=what-is-true>What is true?</h3><p>Anything that is not <code>#f</code> is true <code>#t</code>.</p><h3 id=local-bindings>Local bindings</h3><h4 id=letletletrec>let/let*/letrec</h4><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">1</span><span>(<span style=color:#fe8019>let</span> ([x1 e1]
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">2</span><span>      [x2 e2]
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">3</span><span>      <span style=color:#fe8019>...</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">4</span><span>      [xn en])
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">5</span><span>  e)
</span></span></code></pre></div><p>Racket uses the environment <strong>before</strong> the let-expression to evaluate <code>e1 e2 ... en</code>, which means if <code>en</code> uses <code>x1</code>, <code>x2</code>, that would mean some outer variables of the same name. Instead, the expressions in <code>let*</code> are evaluated in the environment produced from the previous bindings (later ones shadow) .</p><p>The expressions in <code>letrec</code> are evaluated in the environment that includes all th bindings. It is needed for mutual recursion.</p><h3 id=set>set!</h3><p>Racket has assignment statements:</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">1</span><span>(<span style=color:#fe8019>set!</span> x e)
</span></span></code></pre></div><p>Once you have side-effects, sequences are useful:</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">1</span><span>(<span style=color:#fe8019>begin</span> e1 e2 e3)
</span></span></code></pre></div><h3 id=consmcons>cons/mcons</h3><p><code>cons</code> produces pairs or lists. (Actually lists are just extented pairs)</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">1</span><span>(<span style=color:#fe8019>define</span> pr (<span style=color:#fabd2f>cons</span> <span style=color:#d3869b>1</span> (<span style=color:#fabd2f>cons</span> <span style=color:#d3869b>#t</span> <span style=color:#b8bb26>&#34;hi&#34;</span>))) <span style=color:#928374;font-style:italic>; is a pair</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">2</span><span>(<span style=color:#fe8019>define</span> lst (<span style=color:#fabd2f>cons</span> <span style=color:#d3869b>1</span> (<span style=color:#fabd2f>cons</span> <span style=color:#d3869b>#t</span> (<span style=color:#fabd2f>cons</span> <span style=color:#b8bb26>&#34;hi&#34;</span> <span style=color:#fabd2f>null</span>)))) <span style=color:#928374;font-style:italic>; is a list</span>
</span></span></code></pre></div><p><code>mcons</code> is another way to make pairs which allows you to change the value inside piars:</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">1</span><span>(<span style=color:#fe8019>define</span> mpr (<span style=color:#fabd2f>mcons</span> <span style=color:#d3869b>1</span> (<span style=color:#fabd2f>mcons</span> <span style=color:#d3869b>#t</span> <span style=color:#b8bb26>&#34;hi&#34;</span>)))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">2</span><span>(<span style=color:#fabd2f>mcar</span> mpr) <span style=color:#928374;font-style:italic>; 1</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">3</span><span>(<span style=color:#fabd2f>mcdr</span> mpr) <span style=color:#928374;font-style:italic>; (mcons (#t &#34;hi&#34;))</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">4</span><span>(<span style=color:#fabd2f>set-mcdr!</span> mpr <span style=color:#d3869b>47</span>) <span style=color:#928374;font-style:italic>; mpr becomes (mcons 1 47)</span>
</span></span></code></pre></div><p>Related form:</p><ul><li><code>mcons</code></li><li><code>mcar</code></li><li><code>mcdr</code></li><li><code>mpair?</code></li><li><code>set-mcar!</code></li><li><code>set-mcdr!</code></li></ul><h2 id=delayed-evaluation-and-thunk>Delayed Evaluation and Thunk</h2><p>In most programming languages, given <code>e1 e2 ... en</code>, the function arguments <code>e2, ..., en</code> are evaluated once before the function body is executed.
So if we define a function like:</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rkt data-lang=rkt><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">1</span><span>(<span style=color:#fe8019>define</span> (my-if-bad x y z) (<span style=color:#fe8019>if</span> x y z))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">3</span><span>(<span style=color:#fe8019>define</span> (factorial-wrong x)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">4</span><span>  (my-if-bad (<span style=color:#fabd2f>=</span> x <span style=color:#d3869b>0</span>)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">5</span><span>             <span style=color:#d3869b>1</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">6</span><span>             (<span style=color:#fabd2f>*</span> x (factorial-wrong (<span style=color:#fabd2f>-</span> x <span style=color:#d3869b>1</span>)))))
</span></span></code></pre></div><p>if we use <code>if</code> instead of <code>my-if-bad</code>, <code>factorial-wrong</code> acts just like we want. But with <code>my-if-bad</code>, the function never stops because the two branches evaluate at the same time.</p><p>Thanks to lambda, we can delay the evaluation, using the fact that function bodies are not evaluated until the function gets called.</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rkt data-lang=rkt><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">1</span><span>(<span style=color:#fe8019>define</span> (my-if x y z) (<span style=color:#fe8019>if</span> x (y) (z)))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">3</span><span>(<span style=color:#fe8019>define</span> (factorial x)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">4</span><span>  (my-if (<span style=color:#fabd2f>=</span> x <span style=color:#d3869b>0</span>)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">5</span><span>         (<span style=color:#fe8019>lambda</span> () <span style=color:#d3869b>1</span>)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">6</span><span>         (<span style=color:#fe8019>lambda</span> () (<span style=color:#fabd2f>*</span> x (factorial (<span style=color:#fabd2f>-</span> x <span style=color:#d3869b>1</span>))))))
</span></span></code></pre></div><p>The general idiom of using a zero-argument function to delay evaluation is also called a <strong>thunk</strong> (or, thunk the argument).</p><p>By the way,</p><h2 id=lazy-evaluationcall-by-needpromises>Lazy-evaluation/Call-by-need/Promises</h2><h2 id=streams>Streams</h2><p>A stream is an infinite sequence of values.</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 1</span><span><span style=color:#fe8019>#lang </span>racket
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 2</span><span><span style=color:#928374;font-style:italic>; 1 1 1 1 ...</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 3</span><span>(<span style=color:#fe8019>define</span> ones (<span style=color:#fe8019>lambda</span> () (<span style=color:#fabd2f>cons</span> <span style=color:#d3869b>1</span> ones)))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 5</span><span><span style=color:#928374;font-style:italic>; 1 2 3 4 ...</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 6</span><span>(<span style=color:#fe8019>define</span> nats
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 7</span><span>  (<span style=color:#fe8019>letrec</span> ([f (<span style=color:#fe8019>lambda</span> (x) (<span style=color:#fabd2f>cons</span> x (<span style=color:#fe8019>lambda</span> () (f (<span style=color:#fabd2f>+</span> x <span style=color:#d3869b>1</span>)))))])
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 8</span><span>     (<span style=color:#fe8019>lambda</span> () (f <span style=color:#d3869b>1</span>))))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 9</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">10</span><span><span style=color:#928374;font-style:italic>; 2 4 6 8 ...</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">11</span><span>(<span style=color:#fe8019>define</span> power-of-two
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">12</span><span>  (<span style=color:#fe8019>letrec</span> ([f (<span style=color:#fe8019>lambda</span> (x) (<span style=color:#fabd2f>cons</span> x (<span style=color:#fe8019>lambda</span> () (f (<span style=color:#fabd2f>*</span> x <span style=color:#d3869b>2</span>)))))])
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">13</span><span>    (<span style=color:#fe8019>lambda</span> () (f <span style=color:#d3869b>2</span>))))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">14</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">15</span><span><span style=color:#928374;font-style:italic>; higher-order maker</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">16</span><span>(<span style=color:#fe8019>define</span> (stream-maker fn arg)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">17</span><span>  (<span style=color:#fe8019>letrec</span> ([f (<span style=color:#fe8019>lambda</span> (x) (<span style=color:#fabd2f>cons</span> x (<span style=color:#fe8019>lambda</span> () (f (fn x arg)))))])
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">18</span><span>    (<span style=color:#fe8019>lambda</span> () (f arg))))
</span></span></code></pre></div><h2 id=memoization-not-memorization>Memoization (Not Memorization)</h2><p>Memoization is another idiom related to lazy evaluation that does not actually use thunks. To implement memoization we do use mutation: Whenever the function is called with an argument we have not seen before, we compute the answer and then add the result to the table.</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 1</span><span>(<span style=color:#fe8019>define</span> fibonacci
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 2</span><span>  (<span style=color:#fe8019>letrec</span>([memo <span style=color:#fabd2f>null</span>]
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 3</span><span>          [f (<span style=color:#fe8019>lambda</span> (x)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 4</span><span>               (<span style=color:#fe8019>let</span> ([ans (<span style=color:#fabd2f>assoc</span> x memo)])
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 5</span><span>                 (<span style=color:#fe8019>if</span> ans
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 6</span><span>                     (<span style=color:#fabd2f>cdr</span> ans)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 7</span><span>                     (<span style=color:#fe8019>let</span> ([new-ans (<span style=color:#fe8019>if</span> (<span style=color:#fe8019>or</span> (<span style=color:#fabd2f>=</span> x <span style=color:#d3869b>1</span>) (<span style=color:#fabd2f>=</span> x <span style=color:#d3869b>2</span>))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 8</span><span>                                        <span style=color:#d3869b>1</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59"> 9</span><span>                                        (<span style=color:#fabd2f>+</span> (f (<span style=color:#fabd2f>-</span> x <span style=color:#d3869b>1</span>))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">10</span><span>                                           (f (<span style=color:#fabd2f>-</span> x <span style=color:#d3869b>2</span>))))])
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">11</span><span>                       (<span style=color:#fe8019>begin</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">12</span><span>                         (<span style=color:#fe8019>set!</span> memo (<span style=color:#fabd2f>cons</span> (<span style=color:#fabd2f>cons</span> x new-ans) memo))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">13</span><span>                         new-ans)))))])
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">14</span><span>    f))
</span></span></code></pre></div><h2 id=macros>Macros</h2><p>Think about these things about macros and how Racket handles them better than other macro systems(notably C/C++)</p><ul><li>Tokenization</li><li>Parenthesization</li><li>Scope</li></ul><h3 id=syntax-1>Syntax</h3><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">1</span><span>(<span style=color:#fe8019>define-syntax</span> myif
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">2</span><span>  (<span style=color:#fe8019>syntax-rules</span> (then <span style=color:#fe8019>else</span>)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">3</span><span>    [(my-if e1 then e2 <span style=color:#fe8019>else</span> e3)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">4</span><span>     (<span style=color:#fe8019>if</span> e1 e2 e3)]))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">5</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">6</span><span>(<span style=color:#fe8019>define-syntax</span> my-delay
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">7</span><span>  (<span style=color:#fe8019>syntax-rules</span> ()
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">8</span><span>    [(my-delay e)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">9</span><span>     (<span style=color:#fabd2f>mcons</span> <span style=color:#d3869b>#f</span> (<span style=color:#fe8019>lambda</span> () e))]))
</span></span></code></pre></div><h3 id=hygiene>Hygiene</h3><h2 id=recursive-datatypes-via-racketss-struct>Recursive Datatypes Via Rackets&rsquo;s <code>struct</code></h2><p><a href="https://docs.racket-lang.org/reference/define-struct.html?q=struct#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._struct%29%29">https://docs.racket-lang.org/reference/define-struct.html?q=struct#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._struct%29%29</a></p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-racket data-lang=racket><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#756d59">1</span><span>(<span style=color:#fe8019>struct</span> foo (bar baz quux) <span style=color:#fe8019>#:transparent</span>
</span></span></code></pre></div></div></article></div><footer id=footer><img id=image src=/images/avatar.jpg alt><div class=name>📍 🇾🇪</div><div class=name>Ali Almohaya</div><div class=link>Github: <a target=_blank href=https://github.com/almo7aya>@almo7aya</a></div><div class=link>Twitter: <a target=_blank href=https://twitter.com/@almo7aya_>@almo7aya_</a></div><div class=link>LinkedIn: <a target=_blank href=https://linkedin.com/in/almo7aya>Ali Almohaya</a></div><div class=link><a target=_blank href=mailto:alialmohaya@gmail.com>alialmohaya@gmail.com</a></div><div class=license>Licensed under a <a target=_blank href=https://creativecommons.org/licenses/by/4.0/>CC Attribution 4.0
International
License</a></div></footer></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
<script src=/js/code-copy.js></script></html>